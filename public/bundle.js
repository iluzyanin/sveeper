var app=function(){"use strict";function e(){}function t(e,t){for(const n in t)e[n]=t[n];return e}function n(e){return e()}function a(){return Object.create(null)}function r(e){e.forEach(n)}function o(e){return"function"==typeof e}function i(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function l(e,t){e.appendChild(t)}function s(e,t,n){e.insertBefore(t,n||null)}function c(e){e.parentNode.removeChild(e)}function u(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function f(e){return document.createElement(e)}function d(e){return document.createTextNode(e)}function m(){return d(" ")}function h(e,t,n,a){return e.addEventListener(t,n,a),()=>e.removeEventListener(t,n,a)}function g(e,t){t=""+t,e.data!==t&&(e.data=t)}function v(e,t,n){e.style.setProperty(t,n)}function p(e,t){for(let n=0;n<e.options.length;n+=1){const a=e.options[n];if(a.__value===t)return void(a.selected=!0)}}function $(e,t,n){e.classList[n?"add":"remove"](t)}let b;function y(e){b=e}function _(e){(function(){if(!b)throw new Error("Function called outside component initialization");return b})().$$.on_destroy.push(e)}function D(){const e=b;return(t,n)=>{const a=e.$$.callbacks[t];if(a){const r=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);a.slice().forEach(t=>{t.call(e,r)})}}}function x(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach(e=>e(t))}const F=[],w=Promise.resolve();let O=!1;const B=[],S=[],k=[];function N(e){B.push(e)}function C(e){S.push(e)}function W(e){k.push(e)}function E(){const e=new Set;do{for(;F.length;){const e=F.shift();y(e),G(e.$$)}for(;B.length;)B.shift()();for(;S.length;){const t=S.pop();e.has(t)||(t(),e.add(t))}}while(F.length);for(;k.length;)k.pop()();O=!1}function G(e){e.fragment&&(e.update(e.dirty),r(e.before_render),e.fragment.p(e.dirty,e.ctx),e.dirty=null,e.after_render.forEach(C))}let j;function A(){j={remaining:0,callbacks:[]}}function L(){j.remaining||r(j.callbacks)}function U(e){j.callbacks.push(e)}function q(e,t,n){-1!==e.$$.props.indexOf(t)&&(e.$$.bound[t]=n,n(e.$$.ctx[t]))}function I(e,t,a){const{fragment:i,on_mount:l,on_destroy:s,after_render:c}=e.$$;i.m(t,a),C(()=>{const t=l.map(n).filter(o);s?s.push(...t):r(t),e.$$.on_mount=[]}),c.forEach(C)}function M(e,t){e.$$.dirty||(F.push(e),O||(O=!0,w.then(E)),e.$$.dirty=a()),e.$$.dirty[t]=!0}function P(t,n,o,i,l,s){const c=b;y(t);const u=n.props||{},f=t.$$={fragment:null,ctx:null,props:s,update:e,not_equal:l,bound:a(),on_mount:[],on_destroy:[],before_render:[],after_render:[],context:new Map(c?c.$$.context:[]),callbacks:a(),dirty:null};let d=!1;var m;f.ctx=o?o(t,u,(e,n)=>{f.ctx&&l(f.ctx[e],f.ctx[e]=n)&&(f.bound[e]&&f.bound[e](n),d&&M(t,e))}):u,f.update(),d=!0,r(f.before_render),f.fragment=i(f.ctx),n.target&&(n.hydrate?f.fragment.l((m=n.target,Array.from(m.childNodes))):f.fragment.c(),n.intro&&t.$$.fragment.i&&t.$$.fragment.i(),I(t,n.target,n.anchor),E()),y(c)}class z{$destroy(){var t,n;n=!0,(t=this).$$&&(r(t.$$.on_destroy),t.$$.fragment.d(n),t.$$.on_destroy=t.$$.fragment=null,t.$$.ctx={}),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}const T=(e,t,n)=>{const a=e[0].length,r=e.length;t<0||t>a-1||n<0||n>r-1||e[n][t].value++},H=(e,t,n)=>{const a=((e,t)=>{const n=[];for(let t=0;t<e;t++)n[t]=t;for(let t=e-1;t>0;t--){const e=Math.floor(Math.random()*t);n[e]+=n[t],n[t]=n[e]-n[t],n[e]-=n[t]}return n.slice(0,t)})(e*t,n),r=[];for(let n=0;n<t;n++){const t=[];for(let n=0;n<e;n++)t.push({value:0,hasBomb:!1,isOpen:!1});r.push(t)}for(let t=0;t<a.length;t++){const n=Math.floor(a[t]/e),o=a[t]%e;r[n][o].hasBomb=!0,T(r,o-1,n-1),T(r,o,n-1),T(r,o+1,n-1),T(r,o-1,n),T(r,o+1,n),T(r,o-1,n+1),T(r,o,n+1),T(r,o+1,n+1)}return r};var J=[{name:"Beginner",values:{width:8,height:8,bombsCount:10}},{name:"Intermediate",values:{width:13,height:15,bombsCount:40}},{name:"Expert",values:{width:30,height:16,bombsCount:99}}];function K(t){var n,a,o,i,u=t.isOpen?t.hasBomb?"💣":t.value>0?t.value:"":t.hasFlag?"⛳":"";return{c(){var e;n=f("div"),a=d(u),n.className=o="cell value--"+t.value+" svelte-qb9h3k",$(n,"isOpen",t.isOpen),i=[h(n,"click",t.click_handler),h(n,"contextmenu",(e=t.contextmenu_handler,function(t){return t.preventDefault(),e.call(this,t)}))]},m(e,t){s(e,n,t),l(n,a)},p(e,t){(e.isOpen||e.hasBomb||e.value||e.hasFlag)&&u!==(u=t.isOpen?t.hasBomb?"💣":t.value>0?t.value:"":t.hasFlag?"⛳":"")&&g(a,u),e.value&&o!==(o="cell value--"+t.value+" svelte-qb9h3k")&&(n.className=o),(e.value||e.isOpen)&&$(n,"isOpen",t.isOpen)},i:e,o:e,d(e){e&&c(n),r(i)}}}function Q(e,t,n){let{value:a=0,hasFlag:r=!1,hasBomb:o=!1,isOpen:i=!1}=t;return e.$set=(e=>{"value"in e&&n("value",a=e.value),"hasFlag"in e&&n("hasFlag",r=e.hasFlag),"hasBomb"in e&&n("hasBomb",o=e.hasBomb),"isOpen"in e&&n("isOpen",i=e.isOpen)}),{value:a,hasFlag:r,hasBomb:o,isOpen:i,click_handler:function(t){x(e,t)},contextmenu_handler:function(t){x(e,t)}}}class R extends z{constructor(e){super(),P(this,e,Q,K,i,["value","hasFlag","hasBomb","isOpen"])}}function V(e,t,n){const a=Object.create(e);return a.cell=t[n],a.j=n,a}function X(e,t,n){const a=Object.create(e);return a.row=t[n],a.i=n,a}function Y(e){var n,a=[e.cell];let r={};for(var o=0;o<a.length;o+=1)r=t(r,a[o]);var i=new R({props:r});return i.$on("click",function(){return e.click_handler(e)}),i.$on("contextmenu",function(){return e.contextmenu_handler(e)}),{c(){i.$$.fragment.c()},m(e,t){I(i,e,t),n=!0},p(t,n){e=n;var r=t.board?function(e,t){const n={},a={},r={$$scope:1};let o=e.length;for(;o--;){const i=e[o],l=t[o];if(l){for(const e in i)e in l||(a[e]=1);for(const e in l)r[e]||(n[e]=l[e],r[e]=1);e[o]=l}else for(const e in i)r[e]=1}for(const e in a)e in n||(n[e]=void 0);return n}(a,[e.cell]):{};i.$set(r)},i(e){n||(i.$$.fragment.i(e),n=!0)},o(e){i.$$.fragment.o(e),n=!1},d(e){i.$destroy(e)}}}function Z(e){for(var t,n,a,r=e.row,o=[],i=0;i<r.length;i+=1)o[i]=Y(V(e,r,i));function d(e,t,n){o[e]&&(t&&U(()=>{o[e].d(t),o[e]=null}),o[e].o(n))}return{c(){t=f("div");for(var e=0;e<o.length;e+=1)o[e].c();n=m(),t.className="row svelte-q0k2jy"},m(e,r){s(e,t,r);for(var i=0;i<o.length;i+=1)o[i].m(t,null);l(t,n),a=!0},p(e,a){if(e.board){r=a.row;for(var i=0;i<r.length;i+=1){const l=V(a,r,i);o[i]?(o[i].p(e,l),o[i].i(1)):(o[i]=Y(l),o[i].c(),o[i].i(1),o[i].m(t,n))}for(A();i<o.length;i+=1)d(i,1,1);L()}},i(e){if(!a){for(var t=0;t<r.length;t+=1)o[t].i();a=!0}},o(e){o=o.filter(Boolean);for(let e=0;e<o.length;e+=1)d(e,0,0);a=!1},d(e){e&&c(t),u(o,e)}}}function ee(e){for(var t,n,a=e.board,r=[],o=0;o<a.length;o+=1)r[o]=Z(X(e,a,o));function i(e,t,n){r[e]&&(t&&U(()=>{r[e].d(t),r[e]=null}),r[e].o(n))}return{c(){t=f("div");for(var e=0;e<r.length;e+=1)r[e].c();t.className="board svelte-q0k2jy"},m(e,a){s(e,t,a);for(var o=0;o<r.length;o+=1)r[o].m(t,null);n=!0},p(e,n){if(e.board){a=n.board;for(var o=0;o<a.length;o+=1){const i=X(n,a,o);r[o]?(r[o].p(e,i),r[o].i(1)):(r[o]=Z(i),r[o].c(),r[o].i(1),r[o].m(t,null))}for(A();o<r.length;o+=1)i(o,1,1);L()}},i(e){if(!n){for(var t=0;t<a.length;t+=1)r[t].i();n=!0}},o(e){r=r.filter(Boolean);for(let e=0;e<r.length;e+=1)i(e,0,0);n=!1},d(e){e&&c(t),u(r,e)}}}function te(e,t,n){let{board:a=[]}=t;const r=(e,t)=>{const o=a.length,i=a[0].length;if(e>=0&&e<o&&t>=0&&t<i&&!a[e][t].isOpen){if(a[e][t].isOpen=!0,n("board",a),a[e][t].hasFlag=!1,n("board",a),a[e][t].hasBomb)return;0===a[e][t].value&&(r(e-1,t-1),r(e,t-1),r(e+1,t-1),r(e-1,t),r(e+1,t),r(e-1,t+1),r(e,t+1),r(e+1,t+1))}},o=(e,t)=>{a[e][t].isOpen||(a[e][t].hasFlag=!a[e][t].hasFlag,n("board",a))};return e.$set=(e=>{"board"in e&&n("board",a=e.board)}),{board:a,openCell:r,putFlag:o,click_handler:function({i:e,j:t}){return r(e,t)},contextmenu_handler:function({i:e,j:t}){return o(e,t)}}}class ne extends z{constructor(e){super(),P(this,e,te,ee,i,["board"])}}function ae(t){var n,a,r,o,i,u,v=t.hasWon?"😅👍🎉":"😱💥💀";return{c(){n=f("div"),a=f("div"),r=d(v),o=m(),(i=f("div")).textContent="🔄",i.className="restart svelte-13p2ljy",n.className="over svelte-13p2ljy",$(n,"hasWon",t.hasWon),u=h(i,"click",t.handleClick)},m(e,t){s(e,n,t),l(n,a),l(a,r),l(n,o),l(n,i)},p(e,t){e.hasWon&&v!==(v=t.hasWon?"😅👍🎉":"😱💥💀")&&g(r,v),e.hasWon&&$(n,"hasWon",t.hasWon)},i:e,o:e,d(e){e&&c(n),u()}}}function re(e,t,n){let{hasWon:a=!1}=t;const r=D();return e.$set=(e=>{"hasWon"in e&&n("hasWon",a=e.hasWon)}),{hasWon:a,handleClick:()=>{r("restart")}}}class oe extends z{constructor(e){super(),P(this,e,re,ae,i,["hasWon"])}}function ie(t){var n,a,r,o,i,u,h="".padStart(t.maxDigits,"8"),p=t.value.toString().padStart(t.maxDigits,"0");return{c(){n=f("div"),a=f("div"),r=d(h),o=m(),i=f("div"),u=d(p),v(a,"color",t.color),a.className="placeholder svelte-1nimyu6",v(i,"color",t.color),i.className="value svelte-1nimyu6",n.className="number svelte-1nimyu6"},m(e,t){s(e,n,t),l(n,a),l(a,r),l(n,o),l(n,i),l(i,u)},p(e,t){e.maxDigits&&h!==(h="".padStart(t.maxDigits,"8"))&&g(r,h),e.color&&v(a,"color",t.color),(e.value||e.maxDigits)&&p!==(p=t.value.toString().padStart(t.maxDigits,"0"))&&g(u,p),e.color&&v(i,"color",t.color)},i:e,o:e,d(e){e&&c(n)}}}function le(e,t,n){let{value:a=0,maxDigits:r=1,color:o="#e93f33"}=t;return e.$set=(e=>{"value"in e&&n("value",a=e.value),"maxDigits"in e&&n("maxDigits",r=e.maxDigits),"color"in e&&n("color",o=e.color)}),{value:a,maxDigits:r,color:o}}class se extends z{constructor(e){super(),P(this,e,le,ie,i,["value","maxDigits","color"])}}function ce(e,t,n){const a=Object.create(e);return a.difficultyLevel=t[n],a}function ue(e){var t,n,a=e.difficultyLevel.name;return{c(){t=f("option"),n=d(a),t.__value=e.difficultyLevel,t.value=t.__value},m(e,a){s(e,t,a),l(t,n)},p(e,n){t.value=t.__value},d(e){e&&c(t)}}}function fe(e){for(var t,n,a,o,i,d,g,v,$,b=J,y=[],_=0;_<b.length;_+=1)y[_]=ue(ce(e,b,_));var D=new se({props:{maxDigits:3,value:e.time}}),x=new se({props:{maxDigits:2,value:e.remainingFlags,color:"green"}});return{c(){t=f("div"),n=f("select");for(var r=0;r<y.length;r+=1)y[r].c();a=m(),D.$$.fragment.c(),o=m(),i=f("div"),(d=f("div")).textContent="⛳",g=m(),x.$$.fragment.c(),void 0===e.selectedDifficulty&&C(()=>e.select_change_handler.call(n)),n.className="difficulty svelte-374wy4",d.className="flagIcon svelte-374wy4",i.className="remainingFlags svelte-374wy4",t.className="menu svelte-374wy4",$=[h(n,"change",e.select_change_handler),h(n,"change",e.handleChange)]},m(r,c){s(r,t,c),l(t,n);for(var u=0;u<y.length;u+=1)y[u].m(n,null);p(n,e.selectedDifficulty),l(t,a),I(D,t,null),l(t,o),l(t,i),l(i,d),l(i,g),I(x,i,null),v=!0},p(e,t){if(e.difficultyLevels){b=J;for(var a=0;a<b.length;a+=1){const r=ce(t,b,a);y[a]?y[a].p(e,r):(y[a]=ue(r),y[a].c(),y[a].m(n,null))}for(;a<y.length;a+=1)y[a].d(1);y.length=b.length}e.selectedDifficulty&&p(n,t.selectedDifficulty);var r={};e.time&&(r.value=t.time),D.$set(r);var o={};e.remainingFlags&&(o.value=t.remainingFlags),x.$set(o)},i(e){v||(D.$$.fragment.i(e),x.$$.fragment.i(e),v=!0)},o(e){D.$$.fragment.o(e),x.$$.fragment.o(e),v=!1},d(e){e&&c(t),u(y,e),D.$destroy(),x.$destroy(),r($)}}}function de(e,t,n){let{remainingFlags:a=0,selectedDifficulty:r,isGameStarted:o,time:i=0}=t;const l=D();let s;return _(()=>s&&clearInterval(s)),e.$set=(e=>{"remainingFlags"in e&&n("remainingFlags",a=e.remainingFlags),"selectedDifficulty"in e&&n("selectedDifficulty",r=e.selectedDifficulty),"isGameStarted"in e&&n("isGameStarted",o=e.isGameStarted),"time"in e&&n("time",i=e.time)}),e.$$.update=((e={isGameStarted:1,interval:1})=>{(e.isGameStarted||e.interval)&&(o?s||n("interval",s=setInterval(()=>{n("time",i+=1)},1e3)):s&&(clearInterval(s),n("interval",s=null)))}),{remainingFlags:a,selectedDifficulty:r,isGameStarted:o,time:i,handleChange:()=>{l("changeDifficulty")},select_change_handler:function(){r=function(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}(this),n("selectedDifficulty",r),n("difficultyLevels",J)}}}class me extends z{constructor(e){super(),P(this,e,de,fe,i,["remainingFlags","selectedDifficulty","isGameStarted","time"])}}function he(e){var t,n=new oe({props:{hasWon:e.hasDefusedAll}});return n.$on("restart",e.restart),{c(){n.$$.fragment.c()},m(e,a){I(n,e,a),t=!0},p(e,t){var a={};e.hasDefusedAll&&(a.hasWon=t.hasDefusedAll),n.$set(a)},i(e){t||(n.$$.fragment.i(e),t=!0)},o(e){n.$$.fragment.o(e),t=!1},d(e){n.$destroy(e)}}}function ge(e){var t,n,a,r,o,i,u,d=(e.hasBlownUp||e.hasDefusedAll)&&he(e);function h(t){e.menu_selectedDifficulty_binding.call(null,t),a=!0,W(()=>a=!1)}function g(t){e.menu_time_binding.call(null,t),r=!0,W(()=>r=!1)}let v={remainingFlags:e.remainingFlags,isGameStarted:e.isGameStarted};void 0!==e.selectedDifficulty&&(v.selectedDifficulty=e.selectedDifficulty),void 0!==e.time&&(v.time=e.time);var p=new me({props:v});function $(t){e.board_1_board_binding.call(null,t),i=!0,W(()=>i=!1)}N(()=>q(p,"selectedDifficulty",h)),N(()=>q(p,"time",g)),p.$on("changeDifficulty",e.restart);let b={};void 0!==e.board&&(b.board=e.board);var y=new ne({props:b});return N(()=>q(y,"board",$)),{c(){t=f("div"),d&&d.c(),n=m(),p.$$.fragment.c(),o=m(),y.$$.fragment.c(),t.className="game svelte-1fcr0ye"},m(e,a){s(e,t,a),d&&d.m(t,null),l(t,n),I(p,t,null),l(t,o),I(y,t,null),u=!0},p(e,o){o.hasBlownUp||o.hasDefusedAll?d?(d.p(e,o),d.i(1)):((d=he(o)).c(),d.i(1),d.m(t,n)):d&&(A(),U(()=>{d.d(1),d=null}),d.o(1),L());var l={};e.remainingFlags&&(l.remainingFlags=o.remainingFlags),e.isGameStarted&&(l.isGameStarted=o.isGameStarted),!a&&e.selectedDifficulty&&(l.selectedDifficulty=o.selectedDifficulty),!r&&e.time&&(l.time=o.time),p.$set(l);var s={};!i&&e.board&&(s.board=o.board),y.$set(s)},i(e){u||(d&&d.i(),p.$$.fragment.i(e),y.$$.fragment.i(e),u=!0)},o(e){d&&d.o(),p.$$.fragment.o(e),y.$$.fragment.o(e),u=!1},d(e){e&&c(t),d&&d.d(),p.$destroy(),y.$destroy()}}}function ve(e,t,n){let a,r=J[0],o=0;const i=()=>{const{width:e,height:t,bombsCount:i}=r.values;n("board",a=H(e,t,i)),n("time",o=0)};let l,s,c,u;return i(),e.$$.update=((e={selectedDifficulty:1,board:1,hasDefusedAll:1,hasBlownUp:1})=>{(e.selectedDifficulty||e.board)&&n("remainingFlags",l=r.values.bombsCount-a.reduce((e,t)=>e+t.reduce((e,t)=>e+(t.hasFlag?1:0),0),0)),e.board&&n("hasDefusedAll",s=!a.some(e=>e.some(e=>e.hasBomb&&!e.hasFlag))),e.board&&n("hasBlownUp",c=a.some(e=>e.some(e=>e.hasBomb&&e.isOpen))),(e.board||e.hasDefusedAll||e.hasBlownUp)&&n("isGameStarted",u=a.some(e=>e.some(e=>e.hasFlag||e.isOpen))&&!s&&!c),(e.hasDefusedAll||e.hasBlownUp||e.board)&&(s||c)&&a.forEach(e=>e.forEach(e=>e.isOpen=!0))}),{board:a,selectedDifficulty:r,time:o,restart:i,remainingFlags:l,hasDefusedAll:s,hasBlownUp:c,isGameStarted:u,menu_selectedDifficulty_binding:function(e){n("selectedDifficulty",r=e)},menu_time_binding:function(e){n("time",o=e)},board_1_board_binding:function(e){n("board",a=e)}}}return new class extends z{constructor(e){super(),P(this,e,ve,ge,i,[])}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
