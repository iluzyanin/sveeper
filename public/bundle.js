var app=function(){"use strict";function e(){}function n(e,n){for(const t in n)e[t]=n[t];return e}function t(e){return e()}function o(){return Object.create(null)}function r(e){e.forEach(t)}function a(e){return"function"==typeof e}function l(e,n){return e!=e?n==n:e!==n||e&&"object"==typeof e||"function"==typeof e}function c(e,n){e.appendChild(n)}function s(e,n,t){e.insertBefore(n,t||null)}function i(e){e.parentNode.removeChild(e)}function u(e,n){for(let t=0;t<e.length;t+=1)e[t]&&e[t].d(n)}function f(e){return document.createElement(e)}function h(e){return document.createTextNode(e)}function d(){return h(" ")}function m(e,n,t,o){return e.addEventListener(n,t,o),()=>e.removeEventListener(n,t,o)}function g(e,n){n=""+n,e.data!==n&&(e.data=n)}function v(e,n){for(let t=0;t<e.options.length;t+=1){const o=e.options[t];if(o.__value===n)return void(o.selected=!0)}}function p(e,n,t){e.classList[t?"add":"remove"](n)}let $;function b(e){$=e}function _(){const e=$;return(n,t)=>{const o=e.$$.callbacks[n];if(o){const r=function(e,n){const t=document.createEvent("CustomEvent");return t.initCustomEvent(e,!1,!1,n),t}(n,t);o.slice().forEach(n=>{n.call(e,r)})}}}function y(e,n){const t=e.$$.callbacks[n.type];t&&t.slice().forEach(e=>e(n))}const x=[],O=Promise.resolve();let B=!1;const k=[],w=[],F=[];function C(e){w.push(e)}function D(){const e=new Set;do{for(;x.length;){const e=x.shift();b(e),E(e.$$)}for(;k.length;)k.shift()();for(;w.length;){const n=w.pop();e.has(n)||(n(),e.add(n))}}while(x.length);for(;F.length;)F.pop()();B=!1}function E(e){e.fragment&&(e.update(e.dirty),r(e.before_render),e.fragment.p(e.dirty,e.ctx),e.dirty=null,e.after_render.forEach(C))}let W;function N(){W={remaining:0,callbacks:[]}}function j(){W.remaining||r(W.callbacks)}function L(e){W.callbacks.push(e)}function A(e,n,o){const{fragment:l,on_mount:c,on_destroy:s,after_render:i}=e.$$;l.m(n,o),C(()=>{const n=c.map(t).filter(a);s?s.push(...n):r(n),e.$$.on_mount=[]}),i.forEach(C)}function M(e,n){e.$$.dirty||(x.push(e),B||(B=!0,O.then(D)),e.$$.dirty=o()),e.$$.dirty[n]=!0}function U(n,t,a,l,c,s){const i=$;b(n);const u=t.props||{},f=n.$$={fragment:null,ctx:null,props:s,update:e,not_equal:c,bound:o(),on_mount:[],on_destroy:[],before_render:[],after_render:[],context:new Map(i?i.$$.context:[]),callbacks:o(),dirty:null};let h=!1;var d;f.ctx=a?a(n,u,(e,t)=>{f.ctx&&c(f.ctx[e],f.ctx[e]=t)&&(f.bound[e]&&f.bound[e](t),h&&M(n,e))}):u,f.update(),h=!0,r(f.before_render),f.fragment=l(f.ctx),t.target&&(t.hydrate?f.fragment.l((d=t.target,Array.from(d.childNodes))):f.fragment.c(),t.intro&&n.$$.fragment.i&&n.$$.fragment.i(),A(n,t.target,t.anchor),D()),b(i)}class q{$destroy(){var n,t;t=!0,(n=this).$$&&(r(n.$$.on_destroy),n.$$.fragment.d(t),n.$$.on_destroy=n.$$.fragment=null,n.$$.ctx={}),this.$destroy=e}$on(e,n){const t=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return t.push(n),()=>{const e=t.indexOf(n);-1!==e&&t.splice(e,1)}}$set(){}}function S(n){var t,o,a,l,u=n.isOpen?n.hasBomb?"💣":n.value>0?n.value:"":n.hasFlag?"⛳":"";return{c(){var e;t=f("div"),o=h(u),t.className=a="cell value--"+n.value+" svelte-x8v6ht",p(t,"isOpen",n.isOpen),l=[m(t,"click",n.click_handler),m(t,"contextmenu",(e=n.contextmenu_handler,function(n){return n.preventDefault(),e.call(this,n)}))]},m(e,n){s(e,t,n),c(t,o)},p(e,n){(e.isOpen||e.hasBomb||e.value||e.hasFlag)&&u!==(u=n.isOpen?n.hasBomb?"💣":n.value>0?n.value:"":n.hasFlag?"⛳":"")&&g(o,u),e.value&&a!==(a="cell value--"+n.value+" svelte-x8v6ht")&&(t.className=a),(e.value||e.isOpen)&&p(t,"isOpen",n.isOpen)},i:e,o:e,d(e){e&&i(t),r(l)}}}function I(e,n,t){let{value:o=0,hasFlag:r=!1,hasBomb:a=!1,isOpen:l=!1}=n;return e.$set=(e=>{"value"in e&&t("value",o=e.value),"hasFlag"in e&&t("hasFlag",r=e.hasFlag),"hasBomb"in e&&t("hasBomb",a=e.hasBomb),"isOpen"in e&&t("isOpen",l=e.isOpen)}),{value:o,hasFlag:r,hasBomb:a,isOpen:l,click_handler:function(n){y(e,n)},contextmenu_handler:function(n){y(e,n)}}}class P extends q{constructor(e){super(),U(this,e,I,S,l,["value","hasFlag","hasBomb","isOpen"])}}function T(n){var t,o,r,a,l,u,v=n.hasWon?"😅👍🎉":"😱💥💀";return{c(){t=f("div"),o=f("div"),r=h(v),a=d(),(l=f("div")).textContent="🔄",l.className="restart svelte-3mbax",t.className="over svelte-3mbax",u=m(l,"click",n.handleClick)},m(e,n){s(e,t,n),c(t,o),c(o,r),c(t,a),c(t,l)},p(e,n){e.hasWon&&v!==(v=n.hasWon?"😅👍🎉":"😱💥💀")&&g(r,v)},i:e,o:e,d(e){e&&i(t),u()}}}function z(e,n,t){let{hasWon:o=!1}=n;const r=_();return e.$set=(e=>{"hasWon"in e&&t("hasWon",o=e.hasWon)}),{hasWon:o,handleClick:function(){r("restart")}}}class G extends q{constructor(e){super(),U(this,e,z,T,l,["hasWon"])}}const H=(e,n,t)=>{const o=e[0].length,r=e.length;n<0||n>o-1||t<0||t>r-1||e[t][n].value++},J=(e,n,t)=>{const o=((e,n)=>{const t=[];for(let n=0;n<e;n++)t[n]=n;for(let n=e-1;n>0;n--){const e=Math.floor(Math.random()*n);t[e]+=t[n],t[n]=t[e]-t[n],t[e]-=t[n]}return t.slice(0,n)})(e*n,t),r=[];for(let t=0;t<n;t++){const n=[];for(let t=0;t<e;t++)n.push({value:0,hasBomb:!1,isOpen:!1});r.push(n)}for(let n=0;n<o.length;n++){const t=Math.floor(o[n]/e),a=o[n]%e;r[t][a].hasBomb=!0,H(r,a-1,t-1),H(r,a,t-1),H(r,a+1,t-1),H(r,a-1,t),H(r,a+1,t),H(r,a-1,t+1),H(r,a,t+1),H(r,a+1,t+1)}return r};var K=[{name:"Beginner",values:{width:8,height:8,bombsCount:10}},{name:"Intermediate",values:{width:13,height:15,bombsCount:40}},{name:"Expert",values:{width:16,height:30,bombsCount:99}}];function Q(e,n,t){const o=Object.create(e);return o.cell=n[t],o.j=t,o}function R(e,n,t){const o=Object.create(e);return o.row=n[t],o.i=t,o}function V(e,n,t){const o=Object.create(e);return o.difficultyLevel=n[t],o}function X(n){var t,o=new G({props:{hasWon:!1}});return o.$on("restart",n.restart),{c(){o.$$.fragment.c()},m(e,n){A(o,e,n),t=!0},p:e,i(e){t||(o.$$.fragment.i(e),t=!0)},o(e){o.$$.fragment.o(e),t=!1},d(e){o.$destroy(e)}}}function Y(n){var t,o=new G({props:{hasWon:!0}});return o.$on("restart",n.restart),{c(){o.$$.fragment.c()},m(e,n){A(o,e,n),t=!0},p:e,i(e){t||(o.$$.fragment.i(e),t=!0)},o(e){o.$$.fragment.o(e),t=!1},d(e){o.$destroy(e)}}}function Z(e){var n,t,o=e.difficultyLevel.name;return{c(){n=f("option"),t=h(o),n.__value=e.difficultyLevel,n.value=n.__value},m(e,o){s(e,n,o),c(n,t)},p(e,t){n.value=n.__value},d(e){e&&i(n)}}}function ee(e){var t,o=[e.cell];let r={};for(var a=0;a<o.length;a+=1)r=n(r,o[a]);var l=new P({props:r});return l.$on("click",function(){return e.click_handler(e)}),l.$on("contextmenu",function(){return e.contextmenu_handler(e)}),{c(){l.$$.fragment.c()},m(e,n){A(l,e,n),t=!0},p(n,t){e=t;var r=n.board?function(e,n){const t={},o={},r={$$scope:1};let a=e.length;for(;a--;){const l=e[a],c=n[a];if(c){for(const e in l)e in c||(o[e]=1);for(const e in c)r[e]||(t[e]=c[e],r[e]=1);e[a]=c}else for(const e in l)r[e]=1}for(const e in o)e in t||(t[e]=void 0);return t}(o,[e.cell]):{};l.$set(r)},i(e){t||(l.$$.fragment.i(e),t=!0)},o(e){l.$$.fragment.o(e),t=!1},d(e){l.$destroy(e)}}}function ne(e){for(var n,t,o,r=e.row,a=[],l=0;l<r.length;l+=1)a[l]=ee(Q(e,r,l));function h(e,n,t){a[e]&&(n&&L(()=>{a[e].d(n),a[e]=null}),a[e].o(t))}return{c(){n=f("div");for(var e=0;e<a.length;e+=1)a[e].c();t=d(),n.className="row svelte-1x9pslk"},m(e,r){s(e,n,r);for(var l=0;l<a.length;l+=1)a[l].m(n,null);c(n,t),o=!0},p(e,o){if(e.board){r=o.row;for(var l=0;l<r.length;l+=1){const c=Q(o,r,l);a[l]?(a[l].p(e,c),a[l].i(1)):(a[l]=ee(c),a[l].c(),a[l].i(1),a[l].m(n,t))}for(N();l<a.length;l+=1)h(l,1,1);j()}},i(e){if(!o){for(var n=0;n<r.length;n+=1)a[n].i();o=!0}},o(e){a=a.filter(Boolean);for(let e=0;e<a.length;e+=1)h(e,0,0);o=!1},d(e){e&&i(n),u(a,e)}}}function te(e){for(var n,t,o,a,l,p,$,b,_,y,x=e.hasBlownUp&&X(e),O=e.hasDefusedAll&&Y(e),B=K,k=[],w=0;w<B.length;w+=1)k[w]=Z(V(e,B,w));var F=e.board,D=[];for(w=0;w<F.length;w+=1)D[w]=ne(R(e,F,w));function E(e,n,t){D[e]&&(n&&L(()=>{D[e].d(n),D[e]=null}),D[e].o(t))}return{c(){n=f("div"),x&&x.c(),t=d(),O&&O.c(),o=d(),a=f("div"),l=f("select");for(var r=0;r<k.length;r+=1)k[r].c();p=h("\n    ⛳ x "),$=h(e.remainingFlags),b=d();for(r=0;r<D.length;r+=1)D[r].c();void 0===e.selectedDifficulty&&C(()=>e.select_change_handler.call(l)),a.className="menu svelte-1x9pslk",n.className="game svelte-1x9pslk",y=[m(l,"change",e.select_change_handler),m(l,"change",e.restart)]},m(r,i){s(r,n,i),x&&x.m(n,null),c(n,t),O&&O.m(n,null),c(n,o),c(n,a),c(a,l);for(var u=0;u<k.length;u+=1)k[u].m(l,null);v(l,e.selectedDifficulty),c(a,p),c(a,$),c(n,b);for(u=0;u<D.length;u+=1)D[u].m(n,null);_=!0},p(e,r){if(r.hasBlownUp?x?(x.p(e,r),x.i(1)):((x=X(r)).c(),x.i(1),x.m(n,t)):x&&(N(),L(()=>{x.d(1),x=null}),x.o(1),j()),r.hasDefusedAll?O?(O.p(e,r),O.i(1)):((O=Y(r)).c(),O.i(1),O.m(n,o)):O&&(N(),L(()=>{O.d(1),O=null}),O.o(1),j()),e.difficultyLevels){B=K;for(var a=0;a<B.length;a+=1){const n=V(r,B,a);k[a]?k[a].p(e,n):(k[a]=Z(n),k[a].c(),k[a].m(l,null))}for(;a<k.length;a+=1)k[a].d(1);k.length=B.length}if(e.selectedDifficulty&&v(l,r.selectedDifficulty),_&&!e.remainingFlags||g($,r.remainingFlags),e.board){F=r.board;for(a=0;a<F.length;a+=1){const t=R(r,F,a);D[a]?(D[a].p(e,t),D[a].i(1)):(D[a]=ne(t),D[a].c(),D[a].i(1),D[a].m(n,null))}for(N();a<D.length;a+=1)E(a,1,1);j()}},i(e){if(!_){x&&x.i(),O&&O.i();for(var n=0;n<F.length;n+=1)D[n].i();_=!0}},o(e){x&&x.o(),O&&O.o(),D=D.filter(Boolean);for(let e=0;e<D.length;e+=1)E(e,0,0);_=!1},d(e){e&&i(n),x&&x.d(),O&&O.d(),u(k,e),u(D,e),r(y)}}}function oe(e,n,t){let o,r,a,l,c=K[0];function s(){const{width:e,height:n,bombsCount:r}=c.values;t("board",o=J(e,n,r))}function i(e,n){const{width:r,height:a}=c.values;if(e>=0&&e<a&&n>=0&&n<r&&!o[e][n].isOpen){if(o[e][n].isOpen=!0,t("board",o),o[e][n].hasFlag=!1,t("board",o),o[e][n].hasBomb)return;0===o[e][n].value&&(i(e-1,n-1),i(e,n-1),i(e+1,n-1),i(e-1,n),i(e+1,n),i(e-1,n+1),i(e,n+1),i(e+1,n+1))}}function u(e,n){o[e][n].hasFlag=!o[e][n].hasFlag,t("board",o)}return s(),e.$$.update=((e={selectedDifficulty:1,board:1})=>{(e.selectedDifficulty||e.board)&&t("remainingFlags",r=c.values.bombsCount-o.reduce((e,n)=>e+n.reduce((e,n)=>e+(n.hasFlag?1:0),0),0)),e.board&&t("hasDefusedAll",a=!o.some(e=>e.some(e=>e.hasBomb&&!e.hasFlag))),e.board&&t("hasBlownUp",l=o.some(e=>e.some(e=>e.hasBomb&&e.isOpen)))}),{board:o,selectedDifficulty:c,restart:s,openCell:i,putFlag:u,remainingFlags:r,hasDefusedAll:a,hasBlownUp:l,select_change_handler:function(){c=function(e){const n=e.querySelector(":checked")||e.options[0];return n&&n.__value}(this),t("selectedDifficulty",c),t("difficultyLevels",K)},click_handler:function({i:e,j:n}){return i(e,n)},contextmenu_handler:function({i:e,j:n}){return u(e,n)}}}return new class extends q{constructor(e){super(),U(this,e,oe,te,l,[])}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
